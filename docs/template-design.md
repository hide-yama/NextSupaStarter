# テンプレート設計書

## 🎯 テンプレートの目的

このテンプレートは、Next.js × Supabase を用いたモダンなフルスタック開発を、毎回ゼロから構築せずに始められるようにするための“超基本セット”です。特に以下の課題を解決することを目的としています：

* 環境構築に毎回 1 時間以上かかっていた
* Supabase や Vercel との連携が曖昧で再現性がなかった
* 自動テスト・CI の導入が毎回後回しになっていた

## 👤 想定ユーザー

* 自分自身（開発スキル：中級）
* シングル開発を前提（最大 2〜3名までのスケールは許容）
* 将来的には Cursor や他の AI コーディング支援ツールと連携して高速開発を行う前提

## ⚙️ 採用技術と選定理由

| 技術                                         | バージョン | 採用理由                       |
| ------------------------------------------ | ------ | -------------------------- |
| **Next.js (App Router)**                   | 15.x   | フロント・API を統合して扱える構成で保守性が高い |
| **TypeScript**                             | 5.x    | 型安全と自己記述性の向上               |
| **Tailwind CSS**                           | 3.4.x  | UI ライブラリに依存せずに柔軟なスタイリングが可能 |
| **Supabase Cloud**                         | latest | 統一されたクラウド開発環境              |
| **pnpm**                                   | latest | 高速パッケージ管理とディスク容量節約        |
| **ESLint/Prettier**                        | latest | コード品質とフォーマットの統一            |
| **Playwright**                             | latest | E2Eテストの安定性とブラウザ互換性        |
| **Playwright MCP**                         | latest | AI連携E2Eテストの効率化           |
| **GitHub Actions**                         | -      | CI/CDパイプラインの自動化              |

## 🗂 ディレクトリ構成と役割

```txt
NextSupaStarter/
├── .claude/           # Playwright MCP設定
│   ├── settings.json           # 現在アクティブなMCP設定
│   ├── settings.template.json  # 設定テンプレート
│   └── settings.local.json     # 権限設定
├── .github/workflows/ # GitHub Actions CI/CD
├── docs/              # 設計書・開発ガイド
├── scripts/           # 自動化スクリプト
│   └── setup-mcp.sh   # Playwright MCP設定
├── src/               # Next.jsアプリケーション
│   ├── app/           # App Routerページ・レイアウト
│   ├── components/    # 再利用コンポーネント
│   └── lib/           # ユーティリティ・設定
├── supabase/          # Supabase CLI設定・マイグレーション
├── tests/             # E2Eテスト（Playwright）
├── .env.example       # 環境変数テンプレート
├── package.json       # pnpm設定
└── CLAUDE.md         # AI連携管理・MCP詳細設定
```

## 🎯 テンプレート完成の境界線（重要）

**このテンプレートの「完成」とは：外部サービスとの接続直前まで実装された状態**

### 完成の定義

✅ **含まれるもの（実装済み状態）**
- 各種外部サービス連携のコード実装（接続処理まで含む）
- 環境変数の設定箇所とキー名の定義
- 接続テスト用のコード
- エラーハンドリング
- 詳細なセットアップ手順書（MDファイル）

❌ **含まれないもの（利用者が設定）**
- 実際のAPIキーや接続情報
- 外部サービスのアカウント作成
- プロジェクトIDやドメイン情報
- 実際の外部サービスとの接続

### この境界線の意図

1. **再利用性の確保**: 利用者が自分のアカウントで即座に使える
2. **セキュリティ**: 機密情報をテンプレートに含めない
3. **学習効果**: 接続手順を理解しながら進められる
4. **保守性**: 外部サービスの仕様変更に強い

## 🧪 テンプレートのテスト方針

テンプレートの「完成定義」は以下の条件をすべて満たすこと：

1. GitHub でテンプレートをクローンし、`pnpm install` → `pnpm dev` で正常起動できる
2. `.env.local` を `.env.example` からコピーし、明示された値を入力すればログイン〜CRUD 操作が可能
3. `pnpm test` / `pnpm test:e2e` が通る（初期値では空でも OK）
4. Vercel／Supabase をそれぞれの管理画面から手動で接続可能（テンプレート側に接続情報は含まない）

## 🚫 スコープ外の事項

* UIコンポーネントライブラリ（MUI/Chakra UI等）は非搭載
* SEO/i18n対応は非対応（必要時に導入）
* Supabase Cloudの高度な機能（Branching/Team）は対象外
* 複雑なデプロイメント戦略（Blue-Green、Canary等）は対象外

## 🔚 最終成果物

* **テンプレート本体**: 構成済みディレクトリとドキュメント
* **AI連携機能**: Playwright MCPによるE2Eテスト効率化
* **外部サービス連携**: GitHub/Supabase/Vercelの完全対応設計
* **シンプル環境管理**: ローカル開発とVercelデプロイの分離
* **包括的ドキュメント**: README、CLAUDE.md、セットアップガイド

## 🤖 AI連携機能の設計思想

### Playwright MCP 連携
- **E2Eテスト自動化**: ブラウザ操作の自動テスト
- **リアルタイムテスト**: 実際のユーザー操作シミュレーション
- **回帰テスト**: 機能追加時の既存機能確認

### 開発効率の向上
- **Supabase CLI連携**: AIが直接コマンド実行でデータベース操作
- **シンプル環境管理**: .env.localのみで環境切り替え
- **テスト支援**: Playwright MCPでE2Eテスト自動作成・実行

### 学習効果
- **段階的理解**: 手動設定とAI支援のバランス
- **ベストプラクティス**: AIが最適解を提案・実装

---

以上が本テンプレートの設計意図および基本方針です。
